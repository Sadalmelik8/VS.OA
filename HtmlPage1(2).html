<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        //获取后台服务列表
        $.ajax({
            type: "get", //请求的方式，也有get请求
            url: "http://localhost:63342/Management/test/open1.json", //请求地址，后台提供的,这里我在本地自己建立了个json的文件做例子
            data: {},//data是传给后台的字段，后台需要哪些就传入哪些
            dataType: "json", //json格式，后台返回的数据为json格式的。
            beforeSend: LoadFunction, //加载执行方法
            //错误执行方法
            error: erryFunction,
            // 正确执行方法
            success: function (result) {
                var dataObj = result, //返回的result为json格式的数据
                    page = 2,//每页显示条数
                    con = "",
                    pagination = "",
                    age = dataObj.length;
                //页数
                for (var i = 1; i <= Math.ceil(age / page) + 1; i++) {
                    //小于10页
                    if (Math.ceil(age / page) < 10) {
                        pagination += "<li>" + "<a>" + i + "</a>" + "</li>";
                        $("#pagination").html(pagination);
                    }
                    //大于10页
                    if (Math.ceil(age / page) > 10) {
                        pagination += "<li>" + "<a>" + i + "</a>" + "</li>";
                        $("#pagination").html(pagination);
                    }
                }

                $(document).ready(function () {
                    var ul = document.getElementById("pagination");
                    var li = ul.getElementsByTagName("li");
                    var a = ul.getElementsByTagName("a");
                    //标签
                    if (Math.ceil(age / page) >= 11) {
                        for (var i = 10; i < li.length; i++) {
                            li[i].style.display = "none";
                        }

                        li[0].className = "active";
                        a[9].innerHTML = "&raquo;";
                        a[9].id = "a10";
                        for (var i = 1; i <= li.length; i++) {
                            a[i - 1].id = "a" + i;
                            var aid = a[i - 1].id;
                            //每页显示条数
                            $.each(dataObj, function (indexs, items) {
                                if (indexs < page) {
                                    con += "<li>" + "<span>" + indexs + "</span>"
                                        + "<a href='#'>" + items.age + "</a>"
                                        + "<lable>" + items.name + "</lable>"
                                        + "<button></button>" + "<hr/>" + "</li>";
                                    $("#con").html(con); //把内容入到这个div中
                                }
                            });
                            con = "";
                            //点击显示第几页
                            $("#" + aid).click(function (e) {
                                var vid = e.target.id.split('a');
                                var val = document.getElementById(aid).value;
                                //数字页
                                console.log(a[vid[1] - 1].innerText);
                                if (a[vid[1] - 1].innerText != "»") {
                                    for (var i = 0; i < li.length; i++) {
                                        if ((vid[1] - 1) != i) {
                                            li[i].className = "none";
                                        }
                                    }
                                    $.each(dataObj, function (indexs, items) {
                                        if (indexs >= page * (vid[1] - 1) && indexs < page * vid[1]) {
                                            i = li.length - 1;
                                            con += "<li>" + "<span>" + items.id + "</span>"
                                                + "<a href='#'>" + items.age + "</a>"
                                                + "<lable>" + items.name + "</lable>"
                                                + "<button></button>" + "<hr/>" + "</li>";
                                            $("#con").html(con); //把内容入到这个div中
                                            li[vid[1] - 1].className = "active";
                                            control();
                                        }
                                    });
                                    con = "";
                                }
                                //收起
                                if (vid[1] == Math.ceil(age / page) + 1) {
                                    for (var i = 10; i < li.length; i++) {
                                        li[i].style.display = "none";
                                    }
                                    a[9].innerHTML = "&raquo;";
                                }
                                //展开    «
                                if (a[vid[1] - 1].innerText == "»") {
                                    for (var i = 10; i < li.length; i++) {
                                        li[i].style.display = "block";
                                    }
                                    a[9].innerHTML = 10;
                                    a[Math.ceil(age / page)].innerHTML = "&laquo;";
                                }
                            })
                        }
                    }
                });

                //跳转
                $(document).ready(function () {
                    $("#btn04").click(function () {
                        var txt03 = document.getElementById("txt03").value;
                        if (txt03 <= Math.ceil(age / page)) {
                            $.each(dataObj, function (indexs, items) {
                                if (indexs >= page * (txt03 - 1) && indexs < page * txt03) {
                                    //i = li.length - 1;
                                    con += "<li>" + "<span>" + items.id + "</span>"
                                        + "<a href='#'>" + items.age + "</a>"
                                        + "<lable>" + items.name + "</lable>"
                                        + "<button></button>" + "<hr/>" + "</li>";
                                    $("#con").html(con); //把内容入到这个div中
                                    control();
                                }
                                var ul = document.getElementById("pagination");
                                var li = ul.getElementsByTagName("li");
                                for (var i = 0; i < li.length; i++) {
                                    if ((txt03 - 1) != i) {
                                        li[i].className = "none";
                                    }
                                }
                                li[txt03 - 1].className = "active";
                            });
                            con = "";
                        }
                        else {
                            alert("超出范围");
                        }
                    })
                });

                //按钮及控制
                $(document).ready(function () {
                    control();
                })

            }
        });

        function LoadFunction() {
            $("#list").html('加载中...');
        }
        function erryFunction(XMLHttpRequest, textStatus, errorThrown) {
            alert(XMLHttpRequest.status);
            alert(XMLHttpRequest.readyState);
            alert(textStatus);
            alert(errorThrown);
        }
        var control = function () {
            var ul = document.getElementById("con");
            var li = ul.getElementsByTagName("li");
            var btn = ul.getElementsByTagName("button");
            var lable = ul.getElementsByTagName("lable");
            for (var i = 0; i < li.length; i++) {
                if (lable[i].innerText.trim() == 0) {
                    btn[i].innerHTML = "停止";
                    btn[i].style.backgroundColor = "red";
                }
                if (lable[i].innerText.trim() == 1) {
                    btn[i].innerHTML = "启动";
                    btn[i].style.backgroundColor = "green";
                }
                btn[i].id = "btn" + i;
                lable[i].id = "lable" + i;
                var btnid = btn[i].id;
                $("#" + btnid).click(function (e) {
                    var vid = e.target.id.split('btn');
                    console.log(e.target.id);
                    if (lable[vid[1]].innerText.trim() == 0) {
                        lable[vid[1]].innerText = 1;
                        btn[vid[1]].innerHTML = "启动";
                        btn[vid[1]].style.backgroundColor = "green";
                    }
                    else /*(lable[vid[1]].innerText.trim() == 1)*/ {
                        lable[vid[1]].innerText = 0;
                        btn[vid[1]].innerHTML = "停止";
                        btn[vid[1]].style.backgroundColor = "red";
                    }
                })
            }
        }
//刷新
//$(document).ready(function () {
// $("#btn03").click(function () {
// alert();
// $.ajax({
// type: "get", //请求的方式，也有get请求
// url: "http://localhost:54924/test/open.json", //请求地址，后台提供的,这里我在本地自己建立了个json的文件做例子
// data: {},//data是传给后台的字段，后台需要哪些就传入哪些
// dataType: "json", //json格式，后台返回的数据为json格式的。
// beforeSend: LoadFunction, //加载执行方法
// //错误执行方法
// error: erryFunction,
// //正确执行方法
// success: function (result) {
// var dataObj = result, //返回的result为json格式的数据
// con = "";
// $.each(dataObj, function (indexs, items) {
// con += /*"<li>" + " <span>序号</span >" + "<a href='#'>名称</a>" + "<lable>状态</lable>" + "<button>控制</button>" + "</li>" + "</br>" +*/
// "<li>" + "<span>" + items.id + "</span>" + "<a href='#'>" + items.age + "</a>" + "<lable>" + items.name + "</lable>" + "<button></button>" + "<hr/>" + "</li>";
// });
// $("#con").html(con); //把内容入到这个div中即完成
// var ul = document.getElementById("con");
// var li = ul.getElementsByTagName("li");
// var btn = ul.getElementsByTagName("button");
// var lable = ul.getElementsByTagName("lable");
// for (var i = 0; i < li.length; i++) {
// if (lable[i].innerText.trim() == 0) {
// btn[i].innerHTML = "停止";
// btn[i].style.backgroundColor = "red";
// }
// if (lable[i].innerText.trim() == 1) {
// btn[i].innerHTML = "启动";
// btn[i].style.backgroundColor = "green";
// }
// btn[i].id = "btn" + i;
// lable[i].id = "lable" + i;
// var btnid = btn[i].id;
// $("#" + btnid).click(function (e) {
// vid = e.target.id.split('btn');
// console.log(e.target.id);
// //console.log( e.target.id);
// if (lable[vid[1]].innerText.trim() == 0) {
// lable[vid[1]].innerText = 1;
// btn[vid[1]].innerHTML = "启动";
// btn[vid[1]].style.backgroundColor = "green";
// }
// else /*(lable[vid[1]].innerText.trim() == 1)*/ {
// lable[vid[1]].innerText = 0;
// btn[vid[1]].innerHTML = "停止";
// btn[vid[1]].style.backgroundColor = "red";
// }
// })
// }
// }
// })
// })
//})
// //服务控制
//$(document).ready(function () {
// var ul = document.getElementById("con");
// var li = ul.getElementsByTagName("li");
// var btn = ul.getElementsByTagName("button");
// var lable = ul.getElementsByTagName("lable");
// for (var i = 0; i < li.length; i++) {
// var x = btn[i];
// x.tabIndex = i;
// x.onclick = function () {
// var index = this.tabIndex;
// if (lable[index].innerText.trim() == 0) {
// lable[index].innerText = 1;
// btn[index].innerHTML = "启动";
// btn[index].style.backgroundColor = "green";
// //$.ajax({
// // type: "get", //请求的方式，也有get请求
// // url: "http://localhost:54924/test/open.json?age=a[index].innerText&name=lable[index].innerText", //请求地址，后台提供的,这里我在本地自己建立了个json的文件做例子
// // data: {},//data是传给后台的字段，后台需要哪些就传入哪些
// // dataType: "json", //json格式，后台返回的数据为json格式的。
// // beforeSend: LoadFunction, //加载执行方法
// // error: erryFunction, //错误执行方法
// // error: function (XMLHttpRequest, textStatus, errorThrown) {
// // alert(XMLHttpRequest.status);
// // //alert(XMLHttpRequest.readyState);
// // //alert(textStatus);
// // //alert(errorThrown);
// // },
// // success: function (result) {
// // //console.log(con); //可以在控制台打印一下看看，这是拼起来的标签和数据
// // //$("#con").html(con); //把内容入到这个div中即完成
// // }
// //})
// }
// else /*(lable[index].innerText.trim() == 1) */ {
// lable[index].innerText = 0;
// btn[index].innerHTML = "停止";
// btn[index].style.backgroundColor = "red";

// }
// }
// }
//})

// 跨页面传值 查询结果
//$(document).ready(function () {
// $("#btn01").click(function () {
// var txt01 = document.getElementById("txt01").value;
// $.ajax({
// type: "get", //请求的方式，也有get请求
// url: "http://localhost:54924/test/open.json", //请求地址，后台提供的,这里我在本地自己建立了个json的文件做例子
// data: {},//data是传给后台的字段，后台需要哪些就传入哪些
// dataType: "json", //json格式，后台返回的数据为json格式的。
// //beforeSend: LoadFunction, //加载执行方法
// //error: erryFunction, //错误执行方法
// error: function (XMLHttpRequest, textStatus, errorThrown) {
// alert(XMLHttpRequest.status);
// alert(XMLHttpRequest.readyState);
// alert(textStatus);
// alert(errorThrown);
// },
// success: function (result) {
// var dataObj = result;//返回的result为json格式的数据
// $.each(dataObj, function (index, item) {
// if (item.age == txt01) {
// location.href = "/sss.html?age=" + txt01;
// }
// });
// //可以在控制台打印一下看看，这是拼起来的标签和数据
// //$("#sss").html(con); //把内容入到这个div中即完成

// }
// })
// })
//})
//新增服务
//$(document).ready(function () {
// $("#btn02").click(function () {
// var txt02 = document.getElementById("txt02").value;
// $.ajax({
// type: "get", //请求的方式，也有get请求
// url: "http://localhost:54924/test/open.json?age=txt02", //请求地址，后台提供的,这里我在本地自己建立了个json的文件做例子
// data: {},//data是传给后台的字段，后台需要哪些就传入哪些
// dataType: "json", //json格式，后台返回的数据为json格式的。
// beforeSend: LoadFunction, //加载执行方法
// error: erryFunction, //错误执行方法
// error: function (XMLHttpRequest, textStatus, errorThrown) {
// alert(XMLHttpRequest.status);
// //alert(XMLHttpRequest.readyState);
// //alert(textStatus);
// //alert(errorThrown);
// },
// success: function (result) {
// //console.log(con); //可以在控制台打印一下看看，这是拼起来的标签和数据
// //$("#con").html(con); //把内容入到这个div中即完成
// }
// })
// })
//})

    </script>
</head>
<body>
<div id="box">
    <ul id="con"></ul>
    <ul class="pagination" id="pagination">

    </ul>
    <input type="text" id="txt03" />
    <input type="button" id="btn04" value="跳转" />
</div>
</body>
</html>
